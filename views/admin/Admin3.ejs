<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css">
  <link rel="stylesheet" href="https://pingendo.com/assets/bootstrap/bootstrap-4.0.0-beta.1.css" type="text/css"> </head>

<body class="bg-warning">
  <div class="">
    <div class="container mx-auto p-0">
      <div class="row">
        <div class="col-md-12 m-3"> </div>
      </div>
    </div>
  </div>
  <div class="py-5">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <div class="card bg-light text-center px-5py p-4">
            <h4 class="py-0 text-warning"><%= payload.name %>
              <br><%= payload.nickname %></h4>
            <p class="lead text-left mx-auto">อาหารที่แพ้ :<%= payload.allegic%>
              <br>ไซส์เสื้อ :<%= payload.size%></p>
            <h4 class="text-success" id="paid" >จ่ายเงินเรียบร้อยจ้า</h4>
            <h1 class="text-danger" id= "unpaid" >ยังไม่ได้จ่ายเงิน!!</h1>
            <div class="row">
              <div class="col-md-12">
                <a class="btn w-30 m-3 btn-success" id="money-btn-1" style="color: white; text-decoration: underline; cursor: pointer;" >จ่ายเงินเรียบร้อยจ้า</a>
                <a class="btn w-30 m-3 btn-danger" id="money-btn-2"  style="padding: 9px 50px 9px 50px; color: white; text-decoration: underline; cursor: pointer;" >ค้างชำระ</a>
                <a class="btn w-75 m-3 btn-success" id="get-shirt" style="color: white; text-decoration: underline; cursor: pointer;">รับเสื้อเรียบร้อยเด้อ</a>                
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script> 
  $(function () {
      
      <% if( (payload.status === 'จ่ายแล้ว')){ %>  
        $('#unpaid').hide();
        $('#money-btn-1').hide();
        $('#money-btn-2').hide();
      <% } else{ %>
        $("#get-shirt").hide();
         $('#paid').hide();
        <% } %>

      function swapButton() {
        $("#money-btn-1").hide();
        $("#money-btn-2").hide();
        $("#get-shirt").show();
         $('#unpaid').hide();
          $('#paid').show();
      }
      function swapButtonunpaid() {
        $("#money-btn-1").hide();
        $("#money-btn-2").hide();
        $("#get-shirt").show();
      }


      var index = <%=payload.index%>;

      $("#money-btn-1").click(function(){
        swapButton();
         $.ajax({
                url: '/admin/info-money',
                type:'POST',
                data: {index : index},
                success: function (success) {
                   if(success === '0'){
                     alert("มีบางอย่างผิดพลาด");
                     window.location.href = '/admin/confirm' ;  
                    }else{
                      alert("จ่ายเงินเรียบร้อย");
                      $('#unpaid').hide();
                      $('#paid').show();
                    }
                }
            });
      });

      $("#money-btn-2").click(function(){
        swapButtonunpaid();
      });

      $("#get-shirt").click(function(){
           $.ajax({
                url: '/admin/info-shirt',
                type:'POST',
                data :  {index : index},
                success: function (success) {
                    if(success === '0'){
                     alert("มีบางอย่างผิดพลาด");                      
                     window.location.href = '/admin/confirm' ;  
                    }else{
                      alert("รับเสื้อเรียบร้อยแล้วครับ");  
                     window.location.href = '/admin/success/'+index ;  
                    }
                },
                error: (err) => {
                  console.log(err);
                }
            });
      });
  });
</script>
  

</html>